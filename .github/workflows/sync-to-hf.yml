name: Sync GitHub (master) â†’ Hugging Face Space (main)

on:
  push:
    branches:
      - master   # your GitHub branch

jobs:
  sync:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Sync files to Hugging Face Space
        env:
          HF_TOKEN: ${{ secrets.HF_TOKEN }}
        run: |
          echo "ğŸ” Configuring Git"
          git config --global user.email "actions@github.com"
          git config --global user.name "GitHub Actions"

          echo "ğŸ“¥ Cloning Hugging Face Space repo"
          git clone https://codeninja3d:${HF_TOKEN}@huggingface.co/spaces/codeninja3d/agentctl hf-space

          echo "ğŸ“¤ Syncing GitHub files â†’ HF Space (rsync)"
          rsync -av --delete --exclude=".git" ./ hf-space/

          cd hf-space

          echo "ğŸ“Œ Committing changes"
          git add .
          git commit -m "Sync from GitHub on master ($(date))" || echo "No changes"

          echo "â¬†ï¸ Pushing to Hugging Face Space (HF uses main)"
          git push https://codeninja3d:${HF_TOKEN}@huggingface.co/spaces/codeninja3d/agentctl HEAD:main

          echo "ğŸ‰ Sync complete!"
